
var peli = [//1
    {
        'titulo': "Chuky",
        'nombre': "Chuky",
        'horarios': "22:00 - 00:00",
        'director': "Don Mancini",
        'reparto': "Brad Dourif,  Fiona Dourif,  Michael Therriault,  Zak Santiago,  Elisabeth Rosen, Jennifer Tilly,  Alex Vincent,  Adam Hurtig,  Grace Lynn Kung,  Summer H. Howell, Ali Tataryn,  Marina Stephenson Kerr",
        'genero': "Terror | Muñecos. Secuela",
        'sinopsis': "Como parte de la terapia, su psiquiatra utilizará un muñeco cuya aparición coincidirá con una horrible cadena de asesinatos en el centro. Andy, protagonista de las primeras entregas, reaparecerá para ayudar a Nica, y Tiffany, la novia de Chucky, también se dejará caer por la que es la séptima entrega de la saga.",
    },
    //2
    {
        'titulo': "Drive",
        'nombre': "Drive",
        'horarios': "20:00 - 22:00",
        'director': "Nicolas Winding Refn",
        'reparto': "Ryan Gosling,  Carey Mulligan,  Albert Brooks,  Ron Perlman,  Bryan Cranston, Óscar Isaac,  Christina Hendricks,  Tina Huang,  Joe Pingue,  James Biberi, Kaden Leos",
        'genero': "Thriller. Acción. Drama. Cine negro | Neo-noir. Robos & Atracos. Coches / Automovilismo. Cine independiente USA. Película de culto",
        'sinopsis': "Durante el día, Driver (Ryan Gosling) trabaja en un taller y es conductor especialista de cine, pero, algunas noches de forma esporádica, trabaja como chófer para delincuentes. Shannon (Brian Cranston), su jefe, que conoce bien su talento al volante, le busca directores de cine y televisión o criminales que necesiten al mejor conductor para sus fugas, llevándose la correspondiente comisión. Pero el mundo de Driver cambia el día en que conoce a Irene (Carey Mulligan), una guapa vecina que tiene un hijo pequeño y a su marido en la cárcel. (FILMAFFINITY)",
    },
    //3
    {
        'titulo': "El resplandor",
        'nombre': "El Resplandor",
        'horarios': "18:00 - 20:00",
        'director': "Stanley Kubrick",
        'reparto': "Jack Nicholson,  Shelley Duvall,  Danny Lloyd,  Scatman Crothers,  Barry Nelson, Philip Stone,  Joe Turkel,  Lia Beldam,  Billie Gibson,  Barry Dennen,  David Baxt, Manning Redwood,  Lisa Burns,  Louise Burns,  Alison Coleridge,  Norman Gay",
        'genero': "Terror | Sobrenatural. Casas encantadas. Fantasmas. Drama psicológico. Película de culto",
        'sinopsis': "Jack Torrance se traslada con su mujer y su hijo de siete años al impresionante hotel Overlook, en Colorado, para encargarse del mantenimiento de las instalaciones durante la temporada invernal, época en la que permanece cerrado y aislado por la nieve. Su objetivo es encontrar paz y sosiego para escribir una novela. Sin embargo, poco después de su llegada al hotel, al mismo tiempo que Jack empieza a padecer inquietantes trastornos de personalidad, se suceden extraños y espeluznantes fenómenos paranormales.",
    },
    //4
    {
        'titulo': "Heroina",
        'nombre': "Heroina",
        'horarios': "17:00 - 19:00",
        'director': "Gerardo Herrero",
        'reparto': "Adriana Ozores,  Javier Pereira,  Carlos Blanco,  María Bouzas,  Mercedes Castro",
        'genero': "Drama | Drogas. Años 80",
        'sinopsis': "En la década de los 80, Pilar, una mujer madura, casada y muy corriente, descubre que uno de sus tres hijos es adicto a la heroína. Después de un período inicial de incertidumbre, entra en contacto con otros padres que se encuentran en una situación similar y que acuden a un precario centro municipal de ayuda al toxicómano.Muy pronto se da cuenta de que para salvar a su hijo son muchas las cosas que tienen que cambiar tanto fuera como dentro de casa. Así es como emprenderá junto con otros padres, pero, sobre todo, madres, una ardua campaña de denuncia del narcotráfico en Galicia.",
    },
    //5
    {
        'titulo': "Inception",
        'nombre': "Inception",
        'horarios': "16:00 - 18:00",
        'director': "Christopher Nolan",
        'reparto': "Leonardo DiCaprio,  Joseph Gordon-Levitt,  Ellen Page,  Ken Watanabe, Marion Cotillard,  Tom Hardy,  Cillian Murphy,  Tom Berenger,  Michael Caine, Dileep Rao,  Lukas Haas,  Pete Postlethwaite,  Talulah Riley,  Miranda Nolan",
        'genero': "Ciencia ficción. Thriller. Intriga. Acción | Thriller futurista. Robos & Atracos",
        'sinopsis': "Dom Cobb (DiCaprio) es un experto en el arte de apropiarse, durante el sueño, de los secretos del subconsciente ajeno. La extraña habilidad de Cobb le ha convertido en un hombre muy cotizado en el mundo del espionaje, pero también lo ha condenado a ser un fugitivo y, por consiguiente, a renunciar a llevar una vida normal. Su única oportunidad para cambiar de vida será hacer exactamente lo contrario de lo que ha hecho siempre: la incepción, que consiste en implantar una idea en el subconsciente en lugar de sustraerla. Sin embargo, su plan se complica debido a la intervención de alguien que parece predecir cada uno de sus movimientos, alguien a quien sólo Cobb podrá descubrir",
    },
    //6
    {
        'titulo': "Kill Bill",
        'nombre': "Kill Bill",
        'horarios': "15:00 - 17:00",
        'director': "Quentin Tarantino",
        'reparto': "Uma Thurman,  Lucy Liu,  Daryl Hannah,  Vivica A. Fox,  Sonny Chiba, Chiaki Kuriyama,  Michael Bowen,  Julie Dreyfus,  Michael Parks,  David Carradine, Michael Madsen",
        'genero': "Acción. Thriller | Artes marciales. Crimen. Venganza. Película de culto",
        'sinopsis': "El día de su boda, una asesina profesional (Thurman) sufre el ataque de algunos miembros de su propia banda, que obedecen las órdenes de Bill (David Carradine), el jefe de la organización criminal. Logra sobrevivir al ataque, aunque queda en coma. Cuatro años después despierta dominada por un gran deseo de venganza. ",
    },
    //7
    {
        'titulo': "Odisea",
        'nombre': "Odisea",
        'horarios': "14:00 - 16:00",
        'director': "Stanley Kubrick",
        'reparto': "Keir Dullea,  Gary Lockwood,  William Sylvester,  Daniel Richter,  Leonard Rossiter, Margaret Tyzack,  Robert Beatty,  Sean Sullivan,  Frank Miller,  Penny Brahms, Alan Gifford,  Vivian Kubrick",
        'genero': "Ciencia ficción | Aventura espacial. Internet / Informática. Película de culto",
        'sinopsis': "La película de ciencia-ficción por excelencia de la historia del cine narra los diversos periodos de la historia de la humanidad, no sólo del pasado, sino también del futuro. Hace millones de años, antes de la aparición del homo sapiens, unos primates descubren un monolito que los conduce a un estadio de inteligencia superior. Millones de años después, otro monolito, enterrado en una luna, despierta el interés de los científicos. Por último, durante una misión de la NASA, HAL 9000, una máquina dotada de inteligencia artificial, se encarga de controlar todos los sistemas de una nave espacial tripulada.",
    },
    //8
    {
        'titulo': "Pulp Fiction",
        'nombre': "PulpFiction",
        'horarios': "13:00 - 15:00",
        'director': "Quentin Tarantino",
        'reparto': "John Travolta,  Samuel L. Jackson,  Uma Thurman,  Bruce Willis,  Ving Rhames, Harvey Keitel,  Tim Roth,  Amanda Plummer,  María de Medeiros,  Eric Stoltz, Rosanna Arquette,  Christopher Walken,  Paul Calderon,  Bronagh Gallagher, Peter Greene,  Stephen Hibbert,  Angela Jones,  Phil LaMarr,  Robert Ruth, Julia Sweeney,  Quentin Tarantino,  Frank Whaley,  Duane Whitaker,  Steve Buscemi, Burr Steers",
        'genero': "Thriller | Crimen. Historias cruzadas. Película de culto",
        'sinopsis': "Jules y Vincent, dos asesinos a sueldo con no demasiadas luces, trabajan para el gángster Marsellus Wallace. Vincent le confiesa a Jules que Marsellus le ha pedido que cuide de Mia, su atractiva mujer. Jules le recomienda prudencia porque es muy peligroso sobrepasarse con la novia del jefe. Cuando llega la hora de trabajar, ambos deben ponerse manos a la obra. Su misión: recuperar un misterioso maletín.",
    },
    //9
    {
        'titulo': "Resident Evil",
        'horarios': "10:00 - 12:00",
        'nombre': "Resident Evil",
        'director': "Paul W.S. Anderson",
        'reparto': "Milla Jovovich,  Michelle Rodriguez,  Eric Mabius,  James Purefoy,  Pasquale Aleardi, Stephen Billington,  Anna Bolt,  Colin Salmon,  Marisol Nichols,  Heike Makatsch, Joseph May",
        'genero': "Terror. Ciencia ficción. Acción | Zombis. Videojuego",
        'sinopsis': "En un centro clandestino de investigación genética -con fines militares- de una poderosa multinacional se produce un brote vírico que contamina todo el edificio. Para contener la fuga el ordenador que controla el centro sella toda la instalación y, en un principio se cree que mueren todos los empleados, pero en realidad se han convertido en feroces zombis..",
    },
    //10
    {
        'titulo': "Regreso al futuro",
        'horarios': "20:00 - 22:00",
        'nombre': "Regreso al futuro",
        'director': "Robert Zemeckis",
        'reparto': "Michael J. Fox,  Christopher Lloyd,  Lea Thompson,  Crispin Glover,  Claudia Wells, Thomas F. Wilson,  James Tolkan,  Billy Zane,  Sachi Parker",
        'genero': "Ciencia ficción. Comedia. Fantástico. Aventuras | Viajes en el tiempo. Comedia juvenil. Adolescencia. Cine familiar. Película de culto",
        'sinopsis': "El adolescente Marty McFly es amigo de Doc, un científico al que todos toman por loco. Cuando Doc crea una máquina para viajar en el tiempo, un error fortuito hace que Marty llegue a 1955, año en el que sus futuros padres aún no se habían conocido. Después de impedir su primer encuentro, deberá conseguir que se conozcan y se casen; de lo contrario, su existencia no sería posible. ",
    }, ]




var listaPeliculas = [];


for (let i = 0; i < peli.length; i++) {
    listaPeliculas.push(peli[i])
}

$(document).ready(function () {
    cargarImagen()//Se encargar de coger la imagen seleccionada y ponerle sus datos (sinopsis, autor, titulo...)
    darParametros()//Le da las funciones a los botones, mezclado con la comprobacion




    function cargarImagen() {

        //Creo el nodo dependiendo de la imagen seleccionada
        urlImg = localStorage.getItem("peliculaIMG")
        var nodo = `  <div id="pelicula">
                    <img src="img/${urlImg}.gif" alt="ocatvo pelicula" style="width: 120px; height: 180px;" />
                    <input class="botonVotar" type="button" value="TimeBack">
                </div>`;

        console.log(nodo)


        for (let i = 0; i < listaPeliculas.length; i++) {
            //Si coincide la imagen con alguna de las del json, ponla
            if (urlImg === listaPeliculas[i].nombre) {

                var imagen = `<div class="pelicula">
                                <img tabindex="0" src="img/${urlImg}.gif" alt="Pelicula de ${listaPeliculas[i].nombre}"   />
                                <input class="botonVotar" type="button" value="${listaPeliculas[i].nombre}">
                              </div>`;

                var info =
                        `<span tabindex="0" ><strong>Horarios:</strong> ${listaPeliculas[i].horarios}</span>
            <span tabindex="0" ><strong>Titulo:</strong> ${listaPeliculas[i].titulo}</span>
            <span tabindex="0"><strong>Director:</strong> ${listaPeliculas[i].director}</span>
            <span tabindex="0"><strong>Reparto:</strong> ${listaPeliculas[i].reparto}</span>
            <span tabindex="0"><strong>Genero:</strong> ${listaPeliculas[i].genero}</span>
            <span tabindex="0"><strong>Sinopsis:</strong> <br>${listaPeliculas[i].sinopsis}</span>`;

                $("#pelicula1").append(imagen);
                $("#informacion").append(info);

            }
        }

    }
    function darParametros() {

        //Cuando clicas en votar, comprueba los campos, quita el boton de votar 
        //y ponme los botones de las tablas

        $("#votar").on("click", function () {
            //muevo el foco a la ventana sacada
            var focalizar = $('#gra').position().top;
            $('html,body').animate({
                scrollTop: focalizar
            }, 500);
            var listaActual = localStorage.getItem("listaUsuarios")
            var votacion = $("#voto").val()

            if ($("#voto").val() > 10 || $("#voto").val() <= 0 || $("#nombre").val() == "" || $("#apellidos").val() == "" || $("#email").val() == "" || $("#telefono").val() == "" || $("#localidad").val() == "") {
                $("#fallo").css("display", "block")
                $("#fallo").focus()

            } else {
                $("#fallo").css("display", "none")
                $("#gra").css("visibility", "visible")
                $("#graficos1").css("visibility", "visible")
                $("#votacion").css("display", "none")
                $("#votar").css("display", "none")

                var usuario = {

                    "Nombre": $("#nombre").val(),
                    "Apellido": $("#apellidos").val(),
                    "Email": $("#email").val(),
                    "Valoracion": $("#voto").val(),
                    "Telefono": $("#telefono").val(),
                    "Localidad": $("#localidad").val(),
                    "pelicula votada": urlImg
                }


                localStorage.setItem("Usuario", JSON.stringify(usuario))


                if (localStorage.getItem(urlImg) && localStorage.getItem("numVotaciones")) {

                    var puntuacion = localStorage.getItem(urlImg)
                    var resultado = parseInt(puntuacion) + parseInt($("#voto").val())
                    var total = +parseInt(localStorage.getItem("numVotaciones")) + 1
                    localStorage.setItem("numVotaciones", total)
                    localStorage.setItem(urlImg, resultado)
                    console.log(resultado)
                    console.log(total)
                    console.log(localStorage.key(urlImg))
                } else {

                    localStorage.setItem("numVotaciones", 1)
                    localStorage.setItem(urlImg, $("#voto").val())

                }
            }
//1208
            //Cuando clicas muestrame este grafico
            $("#otro").on("click", function () {

                //muevo el foco a la ventana sacada

                var focalizar = $('#gra').position().top;
                $('html,body').animate({
                    scrollTop: focalizar
                }, 500);
                google.charts.load('current', {'packages': ['bar']});
                google.charts.setOnLoadCallback(drawStuff);

                function drawStuff() {
                    var data = new google.visualization.arrayToDataTable([
                        ['Opening Move', 'Percentage'],
                        [peli[0].nombre, parseInt(localStorage.getItem(peli[0].nombre))],
                        [peli[1].nombre, parseInt(localStorage.getItem(peli[1].nombre))],
                        [peli[2].nombre, parseInt(localStorage.getItem(peli[2].nombre))],
                        [peli[3].nombre, parseInt(localStorage.getItem(peli[3].nombre))],
                        [peli[4].nombre, parseInt(localStorage.getItem(peli[4].nombre))],
                        [peli[5].nombre, parseInt(localStorage.getItem(peli[5].nombre))],
                        [peli[6].nombre, parseInt(localStorage.getItem(peli[6].nombre))],
                        [peli[7].nombre, parseInt(localStorage.getItem(peli[7].nombre))],
                        [peli[8].nombre, parseInt(localStorage.getItem(peli[8].nombre))],
                        [peli[9].nombre, parseInt(localStorage.getItem(peli[9].nombre))]
                    ]);

                    var options = {

                        title: 'Numero de votaciones: ' + localStorage.getItem("numVotaciones"),
                        width: 400,
                        'height': 500,
                        legend: {position: 'none'},
                        chart: {
                            title: 'Numero de votaciones: ' + localStorage.getItem("numVotaciones") + ".",
                            subtitle: 'Porcetange de fama'
                        },
                        bars: 'horizontal', // Required for Material Bar Charts.
                        axes: {
                            x: {
                                0: {side: 'top', label: 'Percentage'} // Top x-axis.
                            }
                        },
                        bar: {groupWidth: "90%"}
                    };

                    var chart = new google.charts.Bar(document.getElementById('graficos1'));
                    chart.draw(data, options);
                }
                ;

            })
            //Cuando clicas muestrame este grafico
            $("#barra").on("click", function () {
                //muevo el foco a la ventana sacada

                var focalizar = $('#gra').position().top;
                $('html,body').animate({
                    scrollTop: focalizar
                }, 500);
                $("#barra").addClass("marcado")
                google.charts.load("current", {packages: ["corechart"]});
                google.charts.setOnLoadCallback(drawChart);
                function drawChart() {
                    var data = google.visualization.arrayToDataTable([

                        ['Task', 'Hours per Day'],
                        [peli[0].nombre, parseInt(localStorage.getItem(peli[0].nombre))],
                        [peli[1].nombre, parseInt(localStorage.getItem(peli[1].nombre))],
                        [peli[2].nombre, parseInt(localStorage.getItem(peli[2].nombre))],
                        [peli[3].nombre, parseInt(localStorage.getItem(peli[3].nombre))],
                        [peli[4].nombre, parseInt(localStorage.getItem(peli[4].nombre))],
                        [peli[5].nombre, parseInt(localStorage.getItem(peli[5].nombre))],
                        [peli[6].nombre, parseInt(localStorage.getItem(peli[6].nombre))],
                        [peli[7].nombre, parseInt(localStorage.getItem(peli[7].nombre))],
                        [peli[8].nombre, parseInt(localStorage.getItem(peli[8].nombre))],
                        [peli[9].nombre, parseInt(localStorage.getItem(peli[9].nombre))]

                    ]);

                    var options = {
                        width: 400,
                        'height': 500,
                        title: 'Numero de votaciones: ' + localStorage.getItem("numVotaciones"),
                        pieHole: 0.4,
                    };

                    var chart = new google.visualization.PieChart(document.getElementById('graficos1'));
                    chart.draw(data, options);
                }

            })
            //Cuando clicas muestrame este grafico
            $("#tarta").on("click", function () {


                google.charts.load('current', {'packages': ['corechart']});
                google.charts.setOnLoadCallback(drawChart);

                // Callback that creates and populates a data table,
                // instantiates the pie chart, passes in the data and
                // draws it.

                function drawChart() {

                    // Create the data table.
                    var data = new google.visualization.DataTable();

                    data.addColumn('string', 'Topping');
                    data.addColumn('number', 'Slices');

                    data.addRows([

                        [peli[0].nombre, parseInt(localStorage.getItem(peli[0].nombre))],
                        [peli[1].nombre, parseInt(localStorage.getItem(peli[1].nombre))],
                        [peli[2].nombre, parseInt(localStorage.getItem(peli[2].nombre))],
                        [peli[3].nombre, parseInt(localStorage.getItem(peli[3].nombre))],
                        [peli[4].nombre, parseInt(localStorage.getItem(peli[4].nombre))],
                        [peli[5].nombre, parseInt(localStorage.getItem(peli[5].nombre))],
                        [peli[6].nombre, parseInt(localStorage.getItem(peli[6].nombre))],
                        [peli[7].nombre, parseInt(localStorage.getItem(peli[7].nombre))],
                        [peli[8].nombre, parseInt(localStorage.getItem(peli[8].nombre))],
                        [peli[9].nombre, parseInt(localStorage.getItem(peli[9].nombre))]

                    ]);


                    // Set chart options
                    var options = {
                        'title': 'numero de votaciones: ' + localStorage.getItem("numVotaciones"),
                        width: 400,
                        'height': 500,
                    };

                    // Instantiate and draw our chart, passing in some options.
                    var chart = new google.visualization.PieChart(document.getElementById('graficos1'));
                    chart.draw(data, options);

                }
            });
        });
    }
    
    $("#candela").on("click",function(){
        
        var fecha = Date();
        var compra = {dni:$("#dni").val(), credito:$("#trajeta").val(), hora:fecha};
        localStorage.setItem("DatosCompra",JSON.stringify(compra));
        document.getElementById("panelPeliculas").setAttribute("style","display:none");
        document.getElementById("Gracias").innerHTML="<h1>GRACIAS POR SU COMPRA</h1>"
        
    });
});


 